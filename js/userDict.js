function h(o){return o.replace(/#|\(|\)|,|\s/g,"_")}const d="yourdict";function i(o){return JSON.stringify(o)}function W(o,n=""){if(!o)return n;let s="";try{s=JSON.parse(o)}catch{s=o}return s||n}function e(o,n){n!=null&&localStorage.setItem(`${d}:${o}`,i(n))}function r(o){return W(localStorage.getItem(`${d}:${o}`))}class a{constructor(){this._knownWords={},this._unknownWords={},this._seenWords={},this.targetWords=[],this.load()}get knownWords(){return Object.keys(this._knownWords)}get unknownWords(){return Object.keys(this._unknownWords)}get seenWords(){return Object.keys(this._seenWords)}get knownTargetWords(){return this.targetWords.filter(n=>n in this._knownWords)}get unknownTargetWords(){return this.targetWords.filter(n=>n in this._knownWords)}load(){this._knownWords=r("knownWords")||{},this._unknownWords=r("unknownWords")||{},this._seenWords=r("seenWords")||{},this.targetWords=r("targetWords")||[]}save(){e("knownWords",this._knownWords),e("unknownWords",this._unknownWords),e("seenWords",this._seenWords),e("targetWords",this.targetWords)}_genWordMeta(n){return{createdTime:new Date().toUTCString()}}_addKnownWord(n){this.knownWords.includes(n)||(this.unknownWords.includes(n)&&this.removeUnknownWord(n),this._knownWords[n]=this._genWordMeta(n))}_addUnknownWord(n){this.unknownWords.includes(n)||(this.knownWords.includes(n)&&(console.log("remove knownWord",n),this.removeKnownWord(n),console.log(this._knownWords[n])),this._unknownWords[n]=this._genWordMeta(n))}_addSeenWord(n,s){this.seenWords.includes(n)&&(this._seenWords[n].freq+=s),this._seenWords[n]={...this._genWordMeta(n),freq:s}}addKnownWords(n){for(const s of n)this._addKnownWord(s)}addUnknownWords(n){for(const s of n)this._addUnknownWord(s)}addSeenWords(n){for(const[s,t]of n)this._addSeenWord(s,t)}removeKnownWord(n){delete this._knownWords[n]}removeUnknownWord(n){delete this._unknownWords[n]}}const u=new a;export{h as c,r as g,e as s,u};
